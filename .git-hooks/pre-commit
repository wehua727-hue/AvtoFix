#!/bin/bash

# Git pre-commit hook - Yangi funksiyalarni hujjatlashtirish eslatmasi

echo "ğŸ” O'zgarishlar tekshirilmoqda..."

# O'zgargan fayllarni topish
CHANGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# Agar client yoki server fayllar o'zgargan bo'lsa
if echo "$CHANGED_FILES" | grep -qE "(client/|server/)"; then
    echo ""
    echo "âš ï¸  ESLATMA: Yangi funksiya qo'shildi yoki o'zgartirildi!"
    echo ""
    echo "ğŸ“ Iltimos, quyidagilarni yangilang:"
    echo "   1. beets/ papkasida tegishli .md faylni yangilang"
    echo "   2. agents.md faylini yangilang"
    echo ""
    echo "ğŸ“‚ O'zgargan fayllar:"
    echo "$CHANGED_FILES" | grep -E "(client/|server/)" | sed 's/^/   - /'
    echo ""
    
    # Foydalanuvchidan tasdiqlash so'rash
    read -p "Hujjatlarni yangaladingizmi? (y/n): " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        echo "âŒ Commit bekor qilindi. Iltimos, hujjatlarni yangilang."
        exit 1
    fi
fi

echo "âœ… Commit davom etmoqda..."
exit 0
